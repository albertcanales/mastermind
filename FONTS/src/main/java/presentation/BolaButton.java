package presentation;

import exceptions.presentation.BolaNoExistentException;

import javax.swing.*;
import java.awt.*;

/**
 * Representació de les boles del joc en forma de botó en la interfície de Swing
 * @author Albert Canales Ros
 */
class BolaButton extends Subject {

    /**
     * Botó de la interfície
     */
    private JButton button;

    /**
     * Identificador de la bola
     */
    private String id;

    /**
     * Color del qual es pinta el botó
     */
    private BolaColor bolaColor;

    /**
     * Panell contenidor del botó
     */
    private JPanel panel;

    /**
     * Constructor per defecte, no assigna cap color a la bola
     */
    BolaButton() {
        $$$setupUI$$$();
        initComponents();
    }

    /**
     * Mètode per inicialitzar els components de la interfície
     */
    private void initComponents() {
        setBolaColor(BolaColor.NUL);
        button.addActionListener(actionEvent -> Notify());
    }


    /**
     * Getter de l'identificador de la bola
     */
    String getID() {
        return id;
    }

    /**
     * Setter de l'identificador de la bola
     */
    void setID(String id) {
        this.id = id;
    }

    /**
     * Getter del color de la bola
     */
    BolaColor getBolaColor() {
        return bolaColor;
    }

    /**
     * Setter del color de la bola
     */
    void setBolaColor(BolaColor bolaColor) {
        this.bolaColor = bolaColor;
        if (bolaColor.getColor() != null)
            button.setIcon(new ColorIcon(16, bolaColor.getColor()));
        else
            button.setIcon(null);
    }

    /**
     * Setter de l'estat (activat o desactivat) de la bola
     */
    void setEnabled(Boolean enabled) {
        button.setEnabled(enabled);
    }

    /**
     * Setter de la vora de la bola
     */
    void setBorder(Boolean selected) {
        button.setBorderPainted(selected);
    }

    /**
     * Method generated by IntelliJ IDEA GUI Designer
     * >>> IMPORTANT!! <<<
     * DO NOT edit this method OR call it in your code!
     *
     * @noinspection ALL
     */
    private void $$$setupUI$$$() {
        panel = new JPanel();
        panel.setLayout(new FlowLayout(FlowLayout.CENTER, 1, 1));
        button = new JButton();
        button.setActionCommand("");
        button.setLabel("");
        button.setPreferredSize(new Dimension(25, 25));
        button.setText("");
        panel.add(button);
    }

    /**
     * @noinspection ALL
     */
    public JComponent $$$getRootComponent$$$() {
        return panel;
    }

    /**
     * Classe per pintar un cercle com a icona d'un component de Swing
     * @author Albert Canales Ros
     */
    private static class ColorIcon implements Icon {

        /**
         * Mida de la icona
         */
        private final int size;

        /**
         * Color de la icona
         */
        private final Color color;

        /**
         * Contructor de la icona
         * @param size Mida de la icona
         * @param color Color de la icona
         */
        @SuppressWarnings("SameParameterValue")
        ColorIcon(int size, Color color) {
            this.size = size;
            this.color = color;
        }

        /**
         * Mètode per pintar la icona
         */
        @Override
        public void paintIcon(Component c, Graphics g, int x, int y) {
            Graphics2D g2d = (Graphics2D) g;
            g2d.setRenderingHint(
                    RenderingHints.KEY_ANTIALIASING,
                    RenderingHints.VALUE_ANTIALIAS_ON);
            g2d.setColor(color);
            g2d.fillOval(x, y, size, size);
        }

        /**
         * Getter de l'amplada de la icona
         */
        @Override
        public int getIconWidth() {
            return size;
        }

        /**
         * Getter de l'altura de la icona
         */
        @Override
        public int getIconHeight() {
            return size;
        }
    }
}

/**
 * Enum per encapsular els colors amb els quals es pinten de les boles del joc
 * El valor NUL (null) es fa servir quan no s'ha de pintar cap color.
 * @author Albert Canales Ros
 */
enum BolaColor {

    NUL(null, 0),
    BLANC(Color.WHITE, 1),
    NEGRE(Color.BLACK, 2),
    VERMELL(Color.RED, 3),
    BLAU(Color.BLUE, 4),
    TARONJA(Color.ORANGE, 5),
    ROSA(Color.PINK, 6);

    /**
     * Color per pintar la bola
     */
    private final Color color;

    /**
     * Nombre identificador del color
     */
    private final Integer number;

    /**
     * Constructor de la BolaColor
     * @param color Color de la bola
     * @param number Nombre identificador del color
     */
    BolaColor(Color color, Integer number) {
        this.color = color;
        this.number = number;
    }

    /**
     * Getter del color associat a la BolaColor
     */
    Color getColor() {
        return color;
    }

    /**
     * Getter del nombre associat a la BolaColor
     */
    Integer getNumber() {
        return number;
    }

    /**
     * Mètode per obtenir el BolaColor a partir del seu nombre
     * @param number és el valor que representa el color de la bola
     * @return el BolaColor corresponent al nombre donat
     */
    static BolaColor findByNumber(Integer number) throws BolaNoExistentException {
        for(BolaColor nd : values()){
            if(nd.getNumber().equals(number)){
                return nd;
            }
        }
        throw new BolaNoExistentException();
    }

    /**
     * Getter del nombre total de colors de la bola
     */
    @SuppressWarnings("SameReturnValue")
    static int getNumColors() {
        return 7;
    }
}